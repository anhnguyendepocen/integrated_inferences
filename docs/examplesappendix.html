<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Analysis of canonical models with gbiqq | Integrated Inferences</title>
  <meta name="description" content="Model based strategies for integrating qualitative and quantitative inferences." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Analysis of canonical models with gbiqq | Integrated Inferences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="dnieperriver.png" />
  <meta property="og:description" content="Model based strategies for integrating qualitative and quantitative inferences." />
  <meta name="github-repo" content="rstudio/ii" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Analysis of canonical models with gbiqq | Integrated Inferences" />
  
  <meta name="twitter:description" content="Model based strategies for integrating qualitative and quantitative inferences." />
  <meta name="twitter:image" content="dnieperriver.png" />

<meta name="author" content="Macartan Humphreys and Alan Jacobs" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="final-words.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="headers\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Model based causal inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#the-case-for-causal-models"><i class="fa fa-check"></i><b>1.1</b> The Case for Causal Models</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#the-limits-to-design-based-inference"><i class="fa fa-check"></i><b>1.1.1</b> The limits to design-based inference</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#qualitative-and-mixed-method-inference"><i class="fa fa-check"></i><b>1.1.2</b> Qualitative and mixed-method inference</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#connecting-theory-and-empirics"><i class="fa fa-check"></i><b>1.1.3</b> Connecting theory and empirics</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#key-contributions"><i class="fa fa-check"></i><b>1.2</b> Key contributions</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#the-road-ahead"><i class="fa fa-check"></i><b>1.3</b> The Road Ahead</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="2" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>2</b> Causal Models</a><ul>
<li class="chapter" data-level="2.1" data-path="models.html"><a href="models.html#the-counterfactual-model"><i class="fa fa-check"></i><b>2.1</b> The counterfactual model</a></li>
<li class="chapter" data-level="2.2" data-path="models.html"><a href="models.html#causal-models-and-directed-acyclic-graphs"><i class="fa fa-check"></i><b>2.2</b> Causal Models and Directed Acyclic Graphs</a><ul>
<li class="chapter" data-level="2.2.1" data-path="models.html"><a href="models.html#components-of-a-causal-model"><i class="fa fa-check"></i><b>2.2.1</b> Components of a Causal Model</a></li>
<li class="chapter" data-level="2.2.2" data-path="models.html"><a href="models.html#interpretation-of-functional-equations"><i class="fa fa-check"></i><b>2.2.2</b> Interpretation of functional equations</a></li>
<li class="chapter" data-level="2.2.3" data-path="models.html"><a href="models.html#rules-for-graphing-causal-models"><i class="fa fa-check"></i><b>2.2.3</b> Rules for graphing causal models</a></li>
<li class="chapter" data-level="2.2.4" data-path="models.html"><a href="models.html#conditional-independence-from-dags"><i class="fa fa-check"></i><b>2.2.4</b> Conditional independence from DAGs</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="models.html"><a href="models.html#illustrations"><i class="fa fa-check"></i><b>2.3</b> Illustrations</a><ul>
<li class="chapter" data-level="2.3.1" data-path="models.html"><a href="models.html#welfare-state-reform-pierson-1994"><i class="fa fa-check"></i><b>2.3.1</b> Welfare state reform: Pierson (1994)</a></li>
<li class="chapter" data-level="2.3.2" data-path="models.html"><a href="models.html#military-interventions-saunders-2011"><i class="fa fa-check"></i><b>2.3.2</b> Military Interventions: Saunders (2011)</a></li>
<li class="chapter" data-level="2.3.3" data-path="models.html"><a href="models.html#development-and-democratization-przeworski-and-limongi-1997"><i class="fa fa-check"></i><b>2.3.3</b> Development and Democratization: Przeworski and Limongi (1997)</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="models.html"><a href="models.html#chapter-appendix"><i class="fa fa-check"></i><b>2.4</b> Chapter Appendix</a><ul>
<li class="chapter" data-level="2.4.1" data-path="models.html"><a href="models.html#steps-for-constructing-causal-models"><i class="fa fa-check"></i><b>2.4.1</b> Steps for constructing causal models</a></li>
<li class="chapter" data-level="2.4.2" data-path="models.html"><a href="models.html#model-construction-in-code"><i class="fa fa-check"></i><b>2.4.2</b> Model construction in code</a></li>
<li class="chapter" data-level="2.4.3" data-path="models.html"><a href="models.html#test-yourself-can-you-read-conditional-independence-from-a-graph"><i class="fa fa-check"></i><b>2.4.3</b> Test yourself! Can you read conditional independence from a graph?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="theory.html"><a href="theory.html"><i class="fa fa-check"></i><b>3</b> Theories as causal models</a><ul>
<li class="chapter" data-level="3.1" data-path="theory.html"><a href="theory.html#theory-as-a-lower-level-model"><i class="fa fa-check"></i><b>3.1</b> Theory as a “lower-level” model</a></li>
<li class="chapter" data-level="3.2" data-path="theory.html"><a href="theory.html#illustration-of-unpacking-causal-types"><i class="fa fa-check"></i><b>3.2</b> Illustration of unpacking causal types</a><ul>
<li class="chapter" data-level="3.2.1" data-path="theory.html"><a href="theory.html#type-disaggregation-in-a-mediation-model"><i class="fa fa-check"></i><b>3.2.1</b> Type disaggregation in a mediation model</a></li>
<li class="chapter" data-level="3.2.2" data-path="theory.html"><a href="theory.html#type-disaggregation-in-a-moderation-model"><i class="fa fa-check"></i><b>3.2.2</b> Type disaggregation in a moderation model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="theory.html"><a href="theory.html#rules-for-moving-between-higher--and-lower-level-models"><i class="fa fa-check"></i><b>3.3</b> Rules for moving between higher- and lower-level models</a><ul>
<li class="chapter" data-level="3.3.1" data-path="theory.html"><a href="theory.html#moving-down-levels"><i class="fa fa-check"></i><b>3.3.1</b> Moving down levels</a></li>
<li class="chapter" data-level="3.3.2" data-path="theory.html"><a href="theory.html#moving-up-levels"><i class="fa fa-check"></i><b>3.3.2</b> Moving up levels</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="theory.html"><a href="theory.html#conclusion"><i class="fa fa-check"></i><b>3.4</b> Conclusion</a></li>
<li class="chapter" data-level="3.5" data-path="theory.html"><a href="theory.html#chapter-appendices"><i class="fa fa-check"></i><b>3.5</b> Chapter Appendices</a><ul>
<li class="chapter" data-level="3.5.1" data-path="theory.html"><a href="theory.html#summary-boxes"><i class="fa fa-check"></i><b>3.5.1</b> Summary Boxes</a></li>
<li class="chapter" data-level="3.5.2" data-path="theory.html"><a href="theory.html#illustration-of-a-mapping-from-a-game-to-a-dag"><i class="fa fa-check"></i><b>3.5.2</b> Illustration of a Mapping from a Game to a DAG</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="questions.html"><a href="questions.html"><i class="fa fa-check"></i><b>4</b> Causal Questions</a><ul>
<li class="chapter" data-level="4.1" data-path="questions.html"><a href="questions.html#case-level-causal-effects"><i class="fa fa-check"></i><b>4.1</b> Case-level causal effects</a></li>
<li class="chapter" data-level="4.2" data-path="questions.html"><a href="questions.html#case-level-causal-attribution"><i class="fa fa-check"></i><b>4.2</b> Case-level causal attribution</a></li>
<li class="chapter" data-level="4.3" data-path="questions.html"><a href="questions.html#case-level-explanation"><i class="fa fa-check"></i><b>4.3</b> Case-level explanation</a></li>
<li class="chapter" data-level="4.4" data-path="questions.html"><a href="questions.html#average-causal-effects"><i class="fa fa-check"></i><b>4.4</b> Average causal effects</a></li>
<li class="chapter" data-level="4.5" data-path="questions.html"><a href="questions.html#causal-paths"><i class="fa fa-check"></i><b>4.5</b> Causal Paths</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayeschapter.html"><a href="bayeschapter.html"><i class="fa fa-check"></i><b>5</b> Bayesian Answers</a><ul>
<li class="chapter" data-level="5.1" data-path="bayeschapter.html"><a href="bayeschapter.html#bayes-basics"><i class="fa fa-check"></i><b>5.1</b> Bayes Basics</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayeschapter.html"><a href="bayeschapter.html#simple-instances"><i class="fa fa-check"></i><b>5.1.1</b> Simple instances</a></li>
<li class="chapter" data-level="5.1.2" data-path="bayeschapter.html"><a href="bayeschapter.html#bayes-rule-for-discrete-hypotheses"><i class="fa fa-check"></i><b>5.1.2</b> Bayes’ Rule for Discrete Hypotheses</a></li>
<li class="chapter" data-level="5.1.3" data-path="bayeschapter.html"><a href="bayeschapter.html#the-dirichlet-family-and-bayes-rule-for-continuous-parameters"><i class="fa fa-check"></i><b>5.1.3</b> The Dirichlet family and Bayes’ Rule for Continuous Parameters</a></li>
<li class="chapter" data-level="5.1.4" data-path="bayeschapter.html"><a href="bayeschapter.html#moments"><i class="fa fa-check"></i><b>5.1.4</b> Moments</a></li>
<li class="chapter" data-level="5.1.5" data-path="bayeschapter.html"><a href="bayeschapter.html#bayes-estimation-in-practice"><i class="fa fa-check"></i><b>5.1.5</b> Bayes estimation in practice</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayeschapter.html"><a href="bayeschapter.html#bayes-applied"><i class="fa fa-check"></i><b>5.2</b> Bayes applied</a><ul>
<li class="chapter" data-level="5.2.1" data-path="bayeschapter.html"><a href="bayeschapter.html#bayesian-inference-on-queries"><i class="fa fa-check"></i><b>5.2.1</b> Bayesian Inference on Queries</a></li>
<li class="chapter" data-level="5.2.2" data-path="bayeschapter.html"><a href="bayeschapter.html#simple-bayesian-process-tracing"><i class="fa fa-check"></i><b>5.2.2</b> Simple Bayesian Process Tracing</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bayeschapter.html"><a href="bayeschapter.html#three-principles-of-bayesian-updating"><i class="fa fa-check"></i><b>5.3</b> Three principles of Bayesian updating</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayeschapter.html"><a href="bayeschapter.html#AppPriors"><i class="fa fa-check"></i><b>5.3.1</b> Priors matter</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayeschapter.html"><a href="bayeschapter.html#simultaneous-joint-updating"><i class="fa fa-check"></i><b>5.3.2</b> Simultaneous, joint updating</a></li>
<li class="chapter" data-level="5.3.3" data-path="bayeschapter.html"><a href="bayeschapter.html#posteriors-are-independent-of-the-ordering-of-data"><i class="fa fa-check"></i><b>5.3.3</b> Posteriors are independent of the ordering of data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Model-Based Causal Inference</b></span></li>
<li class="chapter" data-level="6" data-path="pt.html"><a href="pt.html"><i class="fa fa-check"></i><b>6</b> Process Tracing with Causal Models</a><ul>
<li class="chapter" data-level="6.1" data-path="pt.html"><a href="pt.html#process-tracing-and-causal-models"><i class="fa fa-check"></i><b>6.1</b> Process tracing and causal models</a><ul>
<li class="chapter" data-level="6.1.1" data-path="pt.html"><a href="pt.html#the-intuition"><i class="fa fa-check"></i><b>6.1.1</b> The intuition</a></li>
<li class="chapter" data-level="6.1.2" data-path="pt.html"><a href="pt.html#a-formalization-of-the-general-approach"><i class="fa fa-check"></i><b>6.1.2</b> A formalization of the general approach</a></li>
<li class="chapter" data-level="6.1.3" data-path="pt.html"><a href="pt.html#illustration-with-code"><i class="fa fa-check"></i><b>6.1.3</b> Illustration with code</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="pt.html"><a href="pt.html#five-principles"><i class="fa fa-check"></i><b>6.2</b> Five principles</a><ul>
<li class="chapter" data-level="6.2.1" data-path="pt.html"><a href="pt.html#classic-qualitative-tests-are-special-cases-of-updating-on-a-model"><i class="fa fa-check"></i><b>6.2.1</b> Classic qualitative tests are special cases of updating on a model</a></li>
<li class="chapter" data-level="6.2.2" data-path="pt.html"><a href="pt.html#conditional-independence-alone-does-not-provide-probative-value"><i class="fa fa-check"></i><b>6.2.2</b> Conditional independence alone does not provide probative value</a></li>
<li class="chapter" data-level="6.2.3" data-path="pt.html"><a href="pt.html#uncertainty-does-not-alter-inference-for-single-case-causal-inference"><i class="fa fa-check"></i><b>6.2.3</b> Uncertainty does not alter inference for single case causal inference</a></li>
<li class="chapter" data-level="6.2.4" data-path="pt.html"><a href="pt.html#probative-value-requires-d-connection"><i class="fa fa-check"></i><b>6.2.4</b> Probative value requires <span class="math inline">\(d-\)</span>connection</a></li>
<li class="chapter" data-level="6.2.5" data-path="pt.html"><a href="pt.html#probative-value"><i class="fa fa-check"></i><b>6.2.5</b> Probative value</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ptapp.html"><a href="ptapp.html"><i class="fa fa-check"></i><b>7</b> Application: Process Tracing with a Causal Model</a><ul>
<li class="chapter" data-level="7.1" data-path="ptapp.html"><a href="ptapp.html#inequality-and-democratization-the-debate"><i class="fa fa-check"></i><b>7.1</b> Inequality and Democratization: The Debate</a></li>
<li class="chapter" data-level="7.2" data-path="ptapp.html"><a href="ptapp.html#a-structural-causal-model"><i class="fa fa-check"></i><b>7.2</b> A Structural Causal Model</a><ul>
<li class="chapter" data-level="7.2.1" data-path="ptapp.html"><a href="ptapp.html#forming-priors"><i class="fa fa-check"></i><b>7.2.1</b> Forming Priors</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ptapp.html"><a href="ptapp.html#results"><i class="fa fa-check"></i><b>7.3</b> Results</a></li>
<li class="chapter" data-level="7.4" data-path="ptapp.html"><a href="ptapp.html#pathways"><i class="fa fa-check"></i><b>7.4</b> Pathways</a><ul>
<li class="chapter" data-level="7.4.1" data-path="ptapp.html"><a href="ptapp.html#cases-with-incomplete-data"><i class="fa fa-check"></i><b>7.4.1</b> Cases with incomplete data</a></li>
<li class="chapter" data-level="7.4.2" data-path="ptapp.html"><a href="ptapp.html#inferences-for-cases-with-observed-democratization"><i class="fa fa-check"></i><b>7.4.2</b> Inferences for cases with observed democratization</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ptapp.html"><a href="ptapp.html#model-definition-and-inference-in-code"><i class="fa fa-check"></i><b>7.5</b> Model definition and inference in code</a></li>
<li class="chapter" data-level="7.6" data-path="ptapp.html"><a href="ptapp.html#concluding-thoughts"><i class="fa fa-check"></i><b>7.6</b> Concluding thoughts</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mixing.html"><a href="mixing.html"><i class="fa fa-check"></i><b>8</b> Integrated inferences</a><ul>
<li class="chapter" data-level="8.1" data-path="mixing.html"><a href="mixing.html#theres-only-ever-one-case"><i class="fa fa-check"></i><b>8.1</b> There’s only ever one case</a></li>
<li class="chapter" data-level="8.2" data-path="mixing.html"><a href="mixing.html#general-procedure"><i class="fa fa-check"></i><b>8.2</b> General procedure</a><ul>
<li class="chapter" data-level="8.2.1" data-path="mixing.html"><a href="mixing.html#estimation"><i class="fa fa-check"></i><b>8.2.1</b> Estimation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mixing.html"><a href="mixing.html#illustration"><i class="fa fa-check"></i><b>8.3</b> Illustration</a></li>
<li class="chapter" data-level="8.4" data-path="mixing.html"><a href="mixing.html#illustrated-inferences"><i class="fa fa-check"></i><b>8.4</b> Illustrated inferences</a><ul>
<li class="chapter" data-level="8.4.1" data-path="mixing.html"><a href="mixing.html#xy-model"><i class="fa fa-check"></i><b>8.4.1</b> XY model</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mixing.html"><a href="mixing.html#considerations"><i class="fa fa-check"></i><b>8.5</b> Considerations</a><ul>
<li class="chapter" data-level="8.5.1" data-path="mixing.html"><a href="mixing.html#the-identification-problem"><i class="fa fa-check"></i><b>8.5.1</b> The identification problem</a></li>
<li class="chapter" data-level="8.5.2" data-path="mixing.html"><a href="mixing.html#continuous-data"><i class="fa fa-check"></i><b>8.5.2</b> Continuous data</a></li>
<li class="chapter" data-level="8.5.3" data-path="mixing.html"><a href="mixing.html#measurement-error"><i class="fa fa-check"></i><b>8.5.3</b> Measurement error</a></li>
<li class="chapter" data-level="8.5.4" data-path="mixing.html"><a href="mixing.html#spillovers"><i class="fa fa-check"></i><b>8.5.4</b> Spillovers</a></li>
<li class="chapter" data-level="8.5.5" data-path="mixing.html"><a href="mixing.html#clustering-and-other-violations-of-independence"><i class="fa fa-check"></i><b>8.5.5</b> Clustering and other violations of independence</a></li>
<li class="chapter" data-level="8.5.6" data-path="mixing.html"><a href="mixing.html#parameteric-models"><i class="fa fa-check"></i><b>8.5.6</b> Parameteric models</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mixing.html"><a href="mixing.html#conclusion-1"><i class="fa fa-check"></i><b>8.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixingapp.html"><a href="mixingapp.html"><i class="fa fa-check"></i><b>9</b> Mixed-Method Application: Inequality and Democracy Revisited</a><ul>
<li class="chapter" data-level="9.1" data-path="mixingapp.html"><a href="mixingapp.html#a-trained-model"><i class="fa fa-check"></i><b>9.1</b> A trained model</a></li>
<li class="chapter" data-level="9.2" data-path="mixingapp.html"><a href="mixingapp.html#data"><i class="fa fa-check"></i><b>9.2</b> Data</a></li>
<li class="chapter" data-level="9.3" data-path="mixingapp.html"><a href="mixingapp.html#inference"><i class="fa fa-check"></i><b>9.3</b> Inference</a><ul>
<li class="chapter" data-level="9.3.1" data-path="mixingapp.html"><a href="mixingapp.html#did-inequality-cause-democracy"><i class="fa fa-check"></i><b>9.3.1</b> Did inequality <em>cause</em> democracy?</a></li>
<li class="chapter" data-level="9.3.2" data-path="mixingapp.html"><a href="mixingapp.html#did-inequality-prevent-democracy"><i class="fa fa-check"></i><b>9.3.2</b> Did inequality <em>prevent</em> democracy?</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixingapp.html"><a href="mixingapp.html#prior-posterior-comparison-for-multiple-estimands"><i class="fa fa-check"></i><b>9.4</b> Prior / posterior comparison for multiple estimands</a></li>
<li class="chapter" data-level="9.5" data-path="mixingapp.html"><a href="mixingapp.html#discussion"><i class="fa fa-check"></i><b>9.5</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>III Design Choices</b></span></li>
<li class="chapter" data-level="10" data-path="elements-of-design.html"><a href="elements-of-design.html"><i class="fa fa-check"></i><b>10</b> Elements of Design</a><ul>
<li class="chapter" data-level="10.1" data-path="elements-of-design.html"><a href="elements-of-design.html#model-inquiry-data-strategy-answer-strategy"><i class="fa fa-check"></i><b>10.1</b> Model, inquiry, data strategy, answer strategy</a><ul>
<li class="chapter" data-level="10.1.1" data-path="elements-of-design.html"><a href="elements-of-design.html#defining-a-model"><i class="fa fa-check"></i><b>10.1.1</b> Defining a model</a></li>
<li class="chapter" data-level="10.1.2" data-path="elements-of-design.html"><a href="elements-of-design.html#choosing-estimands"><i class="fa fa-check"></i><b>10.1.2</b> Choosing estimands</a></li>
<li class="chapter" data-level="10.1.3" data-path="elements-of-design.html"><a href="elements-of-design.html#selecting-a-data-strategy"><i class="fa fa-check"></i><b>10.1.3</b> Selecting a data strategy</a></li>
<li class="chapter" data-level="10.1.4" data-path="elements-of-design.html"><a href="elements-of-design.html#answer-strategy"><i class="fa fa-check"></i><b>10.1.4</b> Answer strategy</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="elements-of-design.html"><a href="elements-of-design.html#evaluating-a-mixed-method-design"><i class="fa fa-check"></i><b>10.2</b> Evaluating a mixed method design</a><ul>
<li class="chapter" data-level="10.2.1" data-path="elements-of-design.html"><a href="elements-of-design.html#expected-loss-as-a-evaluative-metric"><i class="fa fa-check"></i><b>10.2.1</b> Expected loss as a evaluative metric</a></li>
<li class="chapter" data-level="10.2.2" data-path="elements-of-design.html"><a href="elements-of-design.html#expected-variance-almost-always-goes-down"><i class="fa fa-check"></i><b>10.2.2</b> Expected variance (almost) always goes down</a></li>
<li class="chapter" data-level="10.2.3" data-path="elements-of-design.html"><a href="elements-of-design.html#gains"><i class="fa fa-check"></i><b>10.2.3</b> Gains</a></li>
<li class="chapter" data-level="10.2.4" data-path="elements-of-design.html"><a href="elements-of-design.html#illustration-1"><i class="fa fa-check"></i><b>10.2.4</b> Illustration</a></li>
<li class="chapter" data-level="10.2.5" data-path="elements-of-design.html"><a href="elements-of-design.html#in-code"><i class="fa fa-check"></i><b>10.2.5</b> In code</a></li>
<li class="chapter" data-level="10.2.6" data-path="elements-of-design.html"><a href="elements-of-design.html#other-loss-functions"><i class="fa fa-check"></i><b>10.2.6</b> Other loss functions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="elements-of-design.html"><a href="elements-of-design.html#illustration-of-design-decaration-in-code"><i class="fa fa-check"></i><b>10.3</b> Illustration of Design Decaration in code</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="clue-selection-as-a-decision-problem.html"><a href="clue-selection-as-a-decision-problem.html"><i class="fa fa-check"></i><b>11</b> Clue Selection as a Decision Problem</a><ul>
<li class="chapter" data-level="11.1" data-path="clue-selection-as-a-decision-problem.html"><a href="clue-selection-as-a-decision-problem.html#a-strategic-approach"><i class="fa fa-check"></i><b>11.1</b> A strategic approach</a></li>
<li class="chapter" data-level="11.2" data-path="clue-selection-as-a-decision-problem.html"><a href="clue-selection-as-a-decision-problem.html#clue-selection-with-a-simple-example"><i class="fa fa-check"></i><b>11.2</b> Clue selection with a simple example</a><ul>
<li class="chapter" data-level="11.2.1" data-path="clue-selection-as-a-decision-problem.html"><a href="clue-selection-as-a-decision-problem.html#dependence-on-prior-beliefs"><i class="fa fa-check"></i><b>11.2.1</b> Dependence on prior beliefs</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="clue-selection-as-a-decision-problem.html"><a href="clue-selection-as-a-decision-problem.html#clue-selection-for-the-democratization-model"><i class="fa fa-check"></i><b>11.3</b> Clue selection for the democratization model</a><ul>
<li class="chapter" data-level="11.3.1" data-path="clue-selection-as-a-decision-problem.html"><a href="clue-selection-as-a-decision-problem.html#dynamic-strategies"><i class="fa fa-check"></i><b>11.3.1</b> Dynamic Strategies</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="clue-selection-as-a-decision-problem.html"><a href="clue-selection-as-a-decision-problem.html#flag-check-nas-wanrings"><i class="fa fa-check"></i><b>11.4</b> FLAG: CHECK NAS / WANRINGS</a></li>
<li class="chapter" data-level="11.5" data-path="clue-selection-as-a-decision-problem.html"><a href="clue-selection-as-a-decision-problem.html#conclusion-2"><i class="fa fa-check"></i><b>11.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="wide.html"><a href="wide.html"><i class="fa fa-check"></i><b>12</b> Going wide and going deep</a><ul>
<li class="chapter" data-level="12.1" data-path="wide.html"><a href="wide.html#intuitions-does-a-sufficiently-large-n-always-trump-k"><i class="fa fa-check"></i><b>12.1</b> Intuitions: Does a sufficiently large <span class="math inline">\(N\)</span> always trump <span class="math inline">\(K\)</span>?</a></li>
<li class="chapter" data-level="12.2" data-path="wide.html"><a href="wide.html#evaluating-strategies"><i class="fa fa-check"></i><b>12.2</b> Evaluating strategies</a></li>
<li class="chapter" data-level="12.3" data-path="wide.html"><a href="wide.html#varieties"><i class="fa fa-check"></i><b>12.3</b> Varieties of mixing</a></li>
<li class="chapter" data-level="12.4" data-path="wide.html"><a href="wide.html#probative-value-of-clues"><i class="fa fa-check"></i><b>12.4</b> Probative value of clues</a></li>
<li class="chapter" data-level="12.5" data-path="wide.html"><a href="wide.html#effect-heterogeneity"><i class="fa fa-check"></i><b>12.5</b> Effect Heterogeneity</a></li>
<li class="chapter" data-level="12.6" data-path="wide.html"><a href="wide.html#uncertainty-regarding-assignment-processes"><i class="fa fa-check"></i><b>12.6</b> Uncertainty Regarding Assignment Processes</a></li>
<li class="chapter" data-level="12.7" data-path="wide.html"><a href="wide.html#uncertainty-regarding-the-probative-value-of-clues"><i class="fa fa-check"></i><b>12.7</b> Uncertainty regarding the probative value of clues</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="caseselection.html"><a href="caseselection.html"><i class="fa fa-check"></i><b>13</b> Case selection as a Decision Problem</a><ul>
<li class="chapter" data-level="13.1" data-path="caseselection.html"><a href="caseselection.html#explorations"><i class="fa fa-check"></i><b>13.1</b> Explorations</a><ul>
<li class="chapter" data-level="13.1.1" data-path="caseselection.html"><a href="caseselection.html#procedure"><i class="fa fa-check"></i><b>13.1.1</b> Procedure</a></li>
<li class="chapter" data-level="13.1.2" data-path="caseselection.html"><a href="caseselection.html#illustration-2"><i class="fa fa-check"></i><b>13.1.2</b> Illustration</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="caseselection.html"><a href="caseselection.html#results-from-experiments"><i class="fa fa-check"></i><b>13.2</b> Results from experiments</a></li>
<li class="chapter" data-level="13.3" data-path="caseselection.html"><a href="caseselection.html#different-strategies-for-different-estimands"><i class="fa fa-check"></i><b>13.3</b> Different strategies for different estimands</a></li>
<li class="chapter" data-level="13.4" data-path="caseselection.html"><a href="caseselection.html#where-the-probative-value-is"><i class="fa fa-check"></i><b>13.4</b> Where the probative value is</a></li>
<li class="chapter" data-level="13.5" data-path="caseselection.html"><a href="caseselection.html#chapter-appendix-accounting-for-case-selection"><i class="fa fa-check"></i><b>13.5</b> Chapter Appendix: Accounting for case selection</a><ul>
<li class="chapter" data-level="13.5.1" data-path="caseselection.html"><a href="caseselection.html#independent-case-selection-strategy"><i class="fa fa-check"></i><b>13.5.1</b> Independent case selection strategy</a></li>
<li class="chapter" data-level="13.5.2" data-path="caseselection.html"><a href="caseselection.html#conditional-random-case-selection"><i class="fa fa-check"></i><b>13.5.2</b> Conditional random case selection</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Models in Question</b></span></li>
<li class="chapter" data-level="14" data-path="justifying-models.html"><a href="justifying-models.html"><i class="fa fa-check"></i><b>14</b> Justifying models</a><ul>
<li class="chapter" data-level="14.1" data-path="justifying-models.html"><a href="justifying-models.html#bounds-on-probative-value"><i class="fa fa-check"></i><b>14.1</b> Bounds on probative value</a></li>
<li class="chapter" data-level="14.2" data-path="justifying-models.html"><a href="justifying-models.html#the-possibility-of-identification-of-probative-value-from-experimental-data"><i class="fa fa-check"></i><b>14.2</b> The possibility of identification of probative value from experimental data</a><ul>
<li class="chapter" data-level="14.2.1" data-path="justifying-models.html"><a href="justifying-models.html#mediator"><i class="fa fa-check"></i><b>14.2.1</b> Mediator</a></li>
<li class="chapter" data-level="14.2.2" data-path="justifying-models.html"><a href="justifying-models.html#moderator"><i class="fa fa-check"></i><b>14.2.2</b> Moderator</a></li>
<li class="chapter" data-level="14.2.3" data-path="justifying-models.html"><a href="justifying-models.html#case-level-bounds-from-mixed-data"><i class="fa fa-check"></i><b>14.2.3</b> Case level bounds from mixed data</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="justifying-models.html"><a href="justifying-models.html#learning-across-populations"><i class="fa fa-check"></i><b>14.3</b> Learning across populations</a></li>
<li class="chapter" data-level="14.4" data-path="justifying-models.html"><a href="justifying-models.html#different-models-for-different-sites"><i class="fa fa-check"></i><b>14.4</b> Different models for different sites</a><ul>
<li class="chapter" data-level="14.4.1" data-path="justifying-models.html"><a href="justifying-models.html#observational-and-experimental"><i class="fa fa-check"></i><b>14.4.1</b> Observational and experimental</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="justifying-models.html"><a href="justifying-models.html#causal-discovery"><i class="fa fa-check"></i><b>14.5</b> Causal discovery</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="evaluation.html"><a href="evaluation.html"><i class="fa fa-check"></i><b>15</b> Evaluating models</a><ul>
<li class="chapter" data-level="15.1" data-path="evaluation.html"><a href="evaluation.html#inferences-when-you-dont-buy-your-priors"><i class="fa fa-check"></i><b>15.1</b> Inferences when you don;t buy your priors</a></li>
<li class="chapter" data-level="15.2" data-path="evaluation.html"><a href="evaluation.html#tools-for-evaluating-models"><i class="fa fa-check"></i><b>15.2</b> Tools for evaluating models</a><ul>
<li class="chapter" data-level="15.2.1" data-path="evaluation.html"><a href="evaluation.html#check-conditional-independencies"><i class="fa fa-check"></i><b>15.2.1</b> Check conditional independencies</a></li>
<li class="chapter" data-level="15.2.2" data-path="evaluation.html"><a href="evaluation.html#check-confounding-assumptions"><i class="fa fa-check"></i><b>15.2.2</b> Check confounding assumptions</a></li>
<li class="chapter" data-level="15.2.3" data-path="evaluation.html"><a href="evaluation.html#check-prior-dependence"><i class="fa fa-check"></i><b>15.2.3</b> Check prior dependence</a></li>
<li class="chapter" data-level="15.2.4" data-path="evaluation.html"><a href="evaluation.html#check-fit"><i class="fa fa-check"></i><b>15.2.4</b> Check fit</a></li>
<li class="chapter" data-level="15.2.5" data-path="evaluation.html"><a href="evaluation.html#assess-likelihoods-under-different-models"><i class="fa fa-check"></i><b>15.2.5</b> Assess likelihoods under different models</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="evaluation.html"><a href="evaluation.html#evaluating-the-democracy-inequality-model"><i class="fa fa-check"></i><b>15.3</b> Evaluating the Democracy-Inequality model</a><ul>
<li class="chapter" data-level="15.3.1" data-path="evaluation.html"><a href="evaluation.html#prior-check"><i class="fa fa-check"></i><b>15.3.1</b> Prior check</a></li>
<li class="chapter" data-level="15.3.2" data-path="evaluation.html"><a href="evaluation.html#monotonic-restrictions"><i class="fa fa-check"></i><b>15.3.2</b> Monotonic restrictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>16</b> Final Words</a><ul>
<li class="chapter" data-level="16.1" data-path="final-words.html"><a href="final-words.html#general-lessons"><i class="fa fa-check"></i><b>16.1</b> General lessons</a></li>
<li class="chapter" data-level="16.2" data-path="final-words.html"><a href="final-words.html#worries-about-what-you-have-to-put-in"><i class="fa fa-check"></i><b>16.2</b> Worries about what you have to put in</a></li>
<li class="chapter" data-level="16.3" data-path="final-words.html"><a href="final-words.html#limits-on-what-you-can-get-out"><i class="fa fa-check"></i><b>16.3</b> Limits on what you can get out</a></li>
<li class="chapter" data-level="16.4" data-path="final-words.html"><a href="final-words.html#a-world-of-models-practical-steps-forward-for-collective-cumulation"><i class="fa fa-check"></i><b>16.4</b> A world of models: Practical steps forward for collective cumulation</a></li>
</ul></li>
<li class="part"><span><b>V Appendices</b></span></li>
<li class="chapter" data-level="17" data-path="examplesappendix.html"><a href="examplesappendix.html"><i class="fa fa-check"></i><b>17</b> Analysis of canonical models with <code>gbiqq</code></a><ul>
<li class="chapter" data-level="17.1" data-path="examplesappendix.html"><a href="examplesappendix.html#a-simple-model-and-the-ladder-of-causation"><i class="fa fa-check"></i><b>17.1</b> A simple model and the ladder of causation</a></li>
<li class="chapter" data-level="17.2" data-path="examplesappendix.html"><a href="examplesappendix.html#x-causes-y-with-unmodelled-confounding"><i class="fa fa-check"></i><b>17.2</b> <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span>, with unmodelled confounding</a></li>
<li class="chapter" data-level="17.3" data-path="examplesappendix.html"><a href="examplesappendix.html#an-x-causes-y-with-confounding-modeled"><i class="fa fa-check"></i><b>17.3</b> An <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span>, with confounding modeled</a></li>
<li class="chapter" data-level="17.4" data-path="examplesappendix.html"><a href="examplesappendix.html#illustration-of-the-backdoor-criterion"><i class="fa fa-check"></i><b>17.4</b> Illustration of the backdoor criterion</a></li>
<li class="chapter" data-level="17.5" data-path="examplesappendix.html"><a href="examplesappendix.html#simple-mediation-model"><i class="fa fa-check"></i><b>17.5</b> Simple mediation model</a></li>
<li class="chapter" data-level="17.6" data-path="examplesappendix.html"><a href="examplesappendix.html#simple-moderator-model"><i class="fa fa-check"></i><b>17.6</b> Simple moderator model</a></li>
<li class="chapter" data-level="17.7" data-path="examplesappendix.html"><a href="examplesappendix.html#billy-and-suzys-moderator-and-mediation-model"><i class="fa fa-check"></i><b>17.7</b> Billy and Suzy’s moderator and mediation model</a></li>
<li class="chapter" data-level="17.8" data-path="examplesappendix.html"><a href="examplesappendix.html#an-iv-model"><i class="fa fa-check"></i><b>17.8</b> An IV model</a></li>
<li class="chapter" data-level="17.9" data-path="examplesappendix.html"><a href="examplesappendix.html#an-illustration-of-identification-through-the-frontdoor"><i class="fa fa-check"></i><b>17.9</b> An illustration of identification through the frontdoor</a></li>
<li class="chapter" data-level="17.10" data-path="examplesappendix.html"><a href="examplesappendix.html#a-model-with-a-violation-of-sequential-ignorability"><i class="fa fa-check"></i><b>17.10</b> A model with a violation of sequential ignorability</a></li>
<li class="chapter" data-level="17.11" data-path="examplesappendix.html"><a href="examplesappendix.html#learning-from-a-collider"><i class="fa fa-check"></i><b>17.11</b> Learning from a collider</a></li>
<li class="chapter" data-level="17.12" data-path="examplesappendix.html"><a href="examplesappendix.html#inferring-a-cause-from-symptoms"><i class="fa fa-check"></i><b>17.12</b> Inferring a cause from symptoms</a></li>
<li class="chapter" data-level="17.13" data-path="examplesappendix.html"><a href="examplesappendix.html#a-model-mixing-observational-and-experimental-data"><i class="fa fa-check"></i><b>17.13</b> A model mixing observational and experimental data</a></li>
<li class="chapter" data-level="17.14" data-path="examplesappendix.html"><a href="examplesappendix.html#sample-selection-bias"><i class="fa fa-check"></i><b>17.14</b> Sample selection bias</a></li>
<li class="chapter" data-level="17.15" data-path="examplesappendix.html"><a href="examplesappendix.html#transportation-of-findings-across-contexts"><i class="fa fa-check"></i><b>17.15</b> Transportation of findings across contexts</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/macartan/gbiqq/" target="blank">Uses gbiqq</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Integrated Inferences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="examplesappendix" class="section level1">
<h1><span class="header-section-number">Chapter 17</span> Analysis of canonical models with <code>gbiqq</code></h1>
<hr />
<p>We walk through a set of canonical models and show how to define and analyze them using <code>gbiqq</code>.</p>
<hr />
<div id="a-simple-model-and-the-ladder-of-causation" class="section level2">
<h2><span class="header-section-number">17.1</span> A simple model and the ladder of causation</h2>
<p>We first introduce a simple <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span> model with no confounding and use this to illustrate the “ladder of causation.”</p>
<p>The model is written:</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X -&gt; Y&quot;</span>)
<span class="kw">plot_dag</span>(model)</code></pre>
<p><img src="ii_files/figure-html/ap-XYnoconf-1.png" width="672" /></p>
<!-- The model implies a "parameter matrix" that maps from parameters to causal types. Inspecting the parameter matrix,  confirms that there are no constraints here on possible nodal types  and no unobserved confounding: -->
<p>We will assume a “true” distribution over parameters. Let’s assume that the true effect of 0.5, but that this is not known to researchers. The .5 effect comes from the difference between the share of units with a positive effect (.6) and those with a negative effect (.1). (We say share but we may as well think in terms of the probability that a given unit is of one or other type.)</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">set_parameters</span>(model, <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>, <span class="fl">.2</span>, <span class="fl">.1</span>, <span class="fl">.6</span>, <span class="fl">.1</span>))

<span class="kw">kable</span>(<span class="kw">t</span>(model<span class="op">$</span>parameters))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">X.X0</th>
<th align="right">X.X1</th>
<th align="right">Y.Y00</th>
<th align="right">Y.Y10</th>
<th align="right">Y.Y01</th>
<th align="right">Y.Y11</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">0.2</td>
<td align="right">0.1</td>
<td align="right">0.6</td>
<td align="right">0.1</td>
</tr>
</tbody>
</table>
<p>We can now simulate data using the model:</p>
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(model, <span class="dt">n =</span> <span class="dv">1000</span>)</code></pre>
<p>With a model and data in hand we can now update the model.</p>
<pre class="sourceCode r"><code class="sourceCode r">updated &lt;-<span class="st"> </span><span class="kw">gbiqq</span>(model, data)</code></pre>
<p>From the updated model we can draw posterior inferences over estimands of interest.</p>
<p>We will imagine three estimands, corresponding to Pearl’s “ladder of causation.”</p>
<ul>
<li><p>At the first level we are interested in the distribution of some node, perhaps given the value of another node. This question is answerable from observational data.</p></li>
<li><p>At the second level we are interested in treatment effects: how changing one node changes another. This question is answerable from experimental data.</p></li>
<li><p>At the third level we are interested in counterfactual statements: how would things have been different if some features of the world were different from what they are? Answering this question requires a causal model.</p></li>
</ul>
<p>Here are the results:</p>
<pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span>gbiqq<span class="op">::</span><span class="kw">query_model</span>(
 updated,
 <span class="dt">queries =</span> <span class="kw">list</span>(<span class="st">&quot;Y | X=1&quot;</span> =<span class="st"> &quot;Y&quot;</span>, 
                <span class="dt">ATE =</span> <span class="st">&quot;Y[X=1] - Y[X=0]&quot;</span>, 
                <span class="dt">PC  =</span> <span class="st">&quot;Y[X=1] &gt; Y[X=0]&quot;</span>),
 <span class="dt">subsets =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="st">&quot;X==1 &amp; Y==1&quot;</span>),
 <span class="dt">using =</span> <span class="st">&quot;posteriors&quot;</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Query (rung)</th>
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Association</td>
<td align="left">Y | X=1</td>
<td align="left">All</td>
<td align="left">posteriors</td>
<td align="right">0.48</td>
<td align="right">0.02</td>
</tr>
<tr class="even">
<td align="left">Intervention</td>
<td align="left">ATE</td>
<td align="left">All</td>
<td align="left">posteriors</td>
<td align="right">0.53</td>
<td align="right">0.03</td>
</tr>
<tr class="odd">
<td align="left">Imagining</td>
<td align="left">PC</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">posteriors</td>
<td align="right">0.86</td>
<td align="right">0.08</td>
</tr>
</tbody>
</table>
<p>We see from the posterior variance on PC that we have the greatest difficulty with the third rung. In particular the PC is not identified (the distribution does not tighten even with very large N). For more intuition we graph the posteriors:</p>
<p><img src="ii_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We find that they do not converge but they do place positive mass in the right range. Within this range, the shape of the posterior depends on the priors only.</p>
</div>
<div id="x-causes-y-with-unmodelled-confounding" class="section level2">
<h2><span class="header-section-number">17.2</span> <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span>, with unmodelled confounding</h2>
<p>An <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span> model with confounding can be written:</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X -&gt; Y&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_confound</span>(<span class="kw">list</span>(<span class="dt">X =</span> <span class="st">&quot;(Y[X=1]&gt;Y[X=0])&quot;</span>, <span class="dt">X =</span> <span class="st">&quot;(Y[X=1]&lt;Y[X=0])&quot;</span>, <span class="dt">X =</span> <span class="st">&quot;(Y[X=1] ==1)&quot;</span>))
<span class="kw">plot_dag</span>(model)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>If we look at the parameter matrix implied by this model we see that it has more parameters than nodal types, reflecting the conditional assignment probabilities of <span class="math inline">\(X\)</span> – <span class="math inline">\(X\)</span> can have different assignment probabilities for different nodal types for <span class="math inline">\(Y\)</span>.</p>
<table>
<caption><span id="tab:unnamed-chunk-13">Table 17.1: </span>Parameter matrix for X causes Y model with arbitrary confounding</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">X0.Y00</th>
<th align="right">X1.Y00</th>
<th align="right">X0.Y10</th>
<th align="right">X1.Y10</th>
<th align="right">X0.Y01</th>
<th align="right">X1.Y01</th>
<th align="right">X0.Y11</th>
<th align="right">X1.Y11</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>X0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>X1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>X0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>X1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>X0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>X1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>X0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>X1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>Y00</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Y10</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>Y01</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>Y11</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>With the possibility of any type of confounding, the best we can do is place “Manski bounds” on the average causal effect.</p>
<p>To see this, let’s plot a histogram of our posterior on average causal effects, given lots of data:</p>
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(
    model, <span class="dt">n =</span> <span class="dv">1000</span>, 
    <span class="dt">parameters =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.1</span>, <span class="fl">.1</span>, <span class="fl">.7</span>, <span class="fl">.1</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">updated &lt;-<span class="st"> </span><span class="kw">gbiqq</span>(model, data, <span class="dt">refresh =</span> <span class="dv">0</span>)</code></pre>
<pre><code>## Prior distribution added to model</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>The key thing here is that the posterior on the ATE has shifted, as it should, but it is not tight, even with large data. In fact the distribution of the posterior covers one unit of the range between -1 and 1.</p>
</div>
<div id="an-x-causes-y-with-confounding-modeled" class="section level2">
<h2><span class="header-section-number">17.3</span> An <span class="math inline">\(X\)</span> causes <span class="math inline">\(Y\)</span>, with confounding modeled</h2>
<p>Say now we have a theory that the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is confounded by possibly unobserved variable <span class="math inline">\(C\)</span>. Although <span class="math inline">\(C\)</span> is unobserved we can still include it in the model and observe the confounding it generates by estimating the model on data generated by the model but assuming that we cannot observe <span class="math inline">\(C\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;C -&gt; X -&gt; Y &lt;- C&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_restrictions</span>(<span class="kw">c</span>(
           <span class="st">&quot;(Y[X=1] &lt; Y[X=0]) | (Y[C=1] &lt; Y[C=0])&quot;</span>,  
           <span class="st">&quot;(X[C=1] &lt; X[C=0])&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_parameters</span>(<span class="dt">type =</span> <span class="st">&quot;prior_mean&quot;</span>)  </code></pre>
<p>The ATE estimand in this case is given by:</p>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">All</td>
<td align="left">parameters</td>
<td align="right">0.333</td>
</tr>
</tbody>
</table>
<p>In the first column below we run a regression using data generated from this model but with <span class="math inline">\(C\)</span> unobserved. The second column shows what we would estimate if were able to observe <span class="math inline">\(C\)</span>.</p>
<table style="text-align:center">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Y
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
X
</td>
<td>
0.443<sup>***</sup>
</td>
<td>
0.327<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.009)
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
C
</td>
<td>
</td>
<td>
0.328<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.282<sup>***</sup>
</td>
<td>
0.176<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.006)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
10,000
</td>
<td>
10,000
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.196
</td>
<td>
0.290
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.196
</td>
<td>
0.290
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.448 (df = 9998)
</td>
<td>
0.421 (df = 9997)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
2,438.465<sup>***</sup> (df = 1; 9998)
</td>
<td>
2,042.203<sup>***</sup> (df = 2; 9997)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Our posteriors over the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> and the effect of the unobserved confounder (<span class="math inline">\(C\)</span>) on <span class="math inline">\(Y\)</span> have a joint distributed with negative covariance.</p>
<p>To illustrate we will use the same data but assume priors from model where we do not restrict the relationship between <span class="math inline">\(C\)</span> and <span class="math inline">\(Y\)</span> and show the joint distribution of our posteriors.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;C -&gt; X -&gt; Y &lt;- C&quot;</span>)  <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_restrictions</span>(<span class="st">&quot;(X[C=1] &lt; X[C=0])&quot;</span>) </code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ate &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;saved/appendix_modelled_confound_ate.rds&quot;</span>)
confound &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;saved/appendix_modelled_confound_confound.rds&quot;</span>)

<span class="kw">plot</span>(ate, confound)
<span class="kw">abline</span>(<span class="kw">lm</span>(confound<span class="op">~</span>ate), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="illustration-of-the-backdoor-criterion" class="section level2">
<h2><span class="header-section-number">17.4</span> Illustration of the backdoor criterion</h2>
<p>We can use the same model to illustrate the backdoor criterion. We want to show that estimates of the treatment effect are identified if we have data on <span class="math inline">\(C\)</span> but not otherwise.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;C -&gt; X -&gt; Y &lt;- C&quot;</span>)  <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_parameters</span>(<span class="dt">type =</span> <span class="st">&quot;prior_mean&quot;</span>)  <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_restrictions</span>(<span class="st">&quot;(Y[C=1]&lt;Y[C=0])&quot;</span>)

<span class="co"># Four types of data</span>

N &lt;-<span class="st"> </span><span class="dv">10000</span>

df_close_large &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(model, <span class="dt">n =</span> N)
df_open_large  &lt;-<span class="st"> </span><span class="kw">mutate</span>(data_<span class="dv">1</span>_large, <span class="dt">C =</span> <span class="ot">NA</span>)
df_close_small &lt;-<span class="st"> </span>data_<span class="dv">1</span>_large[<span class="kw">sample</span>(N, <span class="dv">200</span>), ]
df_open_small  &lt;-<span class="st"> </span>data_<span class="dv">2</span>_large[<span class="kw">sample</span>(N, <span class="dv">200</span>), ]</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>We see that with small <span class="math inline">\(n\)</span> (200 units), closing the backdoor (by including data on <span class="math inline">\(C\)</span>) produces a tighter distribution on the ATE. With large <span class="math inline">\(N\)</span> (10,000 units) the distribution around the estimand collapses when the backdoor is closed but not when it is open.</p>
</div>
<div id="simple-mediation-model" class="section level2">
<h2><span class="header-section-number">17.5</span> Simple mediation model</h2>
<p>We define a simple mediation model and illustrate learning about whether <span class="math inline">\(X=1\)</span> caused <span class="math inline">\(Y=1\)</span> from observations of <span class="math inline">\(M\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X -&gt; M -&gt; Y&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_confound</span>(<span class="dt">confound =</span> <span class="kw">list</span>(<span class="dt">X =</span> <span class="st">&quot;M[X=1]==1&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_parameters</span>(<span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>, <span class="fl">.2</span>, <span class="fl">.8</span>, 
                          <span class="fl">.2</span>, <span class="dv">0</span>, <span class="fl">.8</span>, <span class="dv">0</span>, 
                          <span class="fl">.2</span>, <span class="dv">0</span>, <span class="fl">.8</span>, <span class="dv">0</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_dag</span>(model)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Data and estimation:</p>
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(model, <span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">using =</span> <span class="st">&quot;parameters&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">updated &lt;-<span class="st"> </span><span class="kw">gbiqq</span>(model, data)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span>gbiqq<span class="op">::</span><span class="kw">query_model</span>(
    updated, 
    <span class="dt">queries =</span> <span class="kw">list</span>(<span class="dt">COE =</span> <span class="st">&quot;c(Y[X=1] &gt; Y[X=0])&quot;</span>), 
    <span class="dt">subsets =</span> <span class="kw">c</span>(<span class="st">&quot;X==1 &amp; Y==1&quot;</span>, <span class="st">&quot;X==1 &amp; Y==1 &amp; M==0&quot;</span>, <span class="st">&quot;X==1 &amp; Y==1 &amp; M==1&quot;</span>),
    <span class="dt">using =</span> <span class="st">&quot;posteriors&quot;</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">COE</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">posteriors</td>
<td align="right">0.913</td>
<td align="right">0.192</td>
</tr>
<tr class="even">
<td align="left">COE</td>
<td align="left">X==1 &amp; Y==1 &amp; M==0</td>
<td align="left">posteriors</td>
<td align="right">0.039</td>
<td align="right">0.106</td>
</tr>
<tr class="odd">
<td align="left">COE</td>
<td align="left">X==1 &amp; Y==1 &amp; M==1</td>
<td align="left">posteriors</td>
<td align="right">0.914</td>
<td align="right">0.192</td>
</tr>
</tbody>
</table>
<p>Note that observation of <span class="math inline">\(M=0\)</span> results in a 0 probability for the posterior that <span class="math inline">\(X\)</span> caused <span class="math inline">\(Y\)</span>, while observation of <span class="math inline">\(M=1\)</span> has only a modest positive effect. The mediator thus provides a hoop test for the proposition that <span class="math inline">\(X\)</span> caused <span class="math inline">\(Y\)</span>.</p>
</div>
<div id="simple-moderator-model" class="section level2">
<h2><span class="header-section-number">17.6</span> Simple moderator model</h2>
<p>We define a simple model with a moderator and illustrate how updating about COE is possible using the value of a mediator as a clue.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X -&gt; Y; Z -&gt; Y&quot;</span>) 
<span class="kw">plot_dag</span>(model)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(
    model, <span class="dt">n =</span> <span class="dv">1000</span>, 
    <span class="dt">parameters =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, 
                   <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>,
                   <span class="fl">.02</span>, <span class="fl">.70</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>, <span class="fl">.02</span>))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">posterior &lt;-<span class="st"> </span><span class="kw">gbiqq</span>(model, data)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span>gbiqq<span class="op">::</span><span class="kw">query_model</span>(
    updated, 
    <span class="dt">queries =</span> <span class="kw">list</span>(<span class="dt">COE =</span> <span class="st">&quot;Y[X=1] &gt; Y[X=0]&quot;</span>), 
    <span class="dt">subsets =</span> <span class="kw">list</span>(<span class="st">&quot;X==1 &amp; Y==1&quot;</span>, <span class="st">&quot;X==1 &amp; Y==1 &amp; Z==0&quot;</span>, <span class="st">&quot;X==1 &amp; Y==1 &amp; Z==1&quot;</span>),
    <span class="dt">using =</span> <span class="st">&quot;posteriors&quot;</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">COE</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">posteriors</td>
<td align="right">0.795</td>
<td align="right">0.044</td>
</tr>
<tr class="even">
<td align="left">COE</td>
<td align="left">X==1 &amp; Y==1 &amp; Z==0</td>
<td align="left">posteriors</td>
<td align="right">0.404</td>
<td align="right">0.143</td>
</tr>
<tr class="odd">
<td align="left">COE</td>
<td align="left">X==1 &amp; Y==1 &amp; Z==1</td>
<td align="left">posteriors</td>
<td align="right">0.883</td>
<td align="right">0.037</td>
</tr>
</tbody>
</table>
<p>As an exercise, define a model where, learning about a model with moderators allows you to tighten bounds on COE even without observing the value of the mediator.</p>
</div>
<div id="billy-and-suzys-moderator-and-mediation-model" class="section level2">
<h2><span class="header-section-number">17.7</span> Billy and Suzy’s moderator and mediation model</h2>
<p>We can describe a simple version of the Billy and Suzy stone throwing game as a model with moderation and mediation in three nodes.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;Suzy -&gt; Billy -&gt; Smash &lt;- Suzy&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_restrictions</span>(<span class="kw">c</span>(
           
           <span class="co"># If Suzy throws the bottle breaks</span>
           <span class="st">&quot;(Smash[Suzy=1]==0)&quot;</span>,

           <span class="co"># The bottle won&#39;t break by itself</span>
           <span class="st">&quot;(Smash[Billy=0, Suzy = 0]==1)&quot;</span>,
           
           <span class="co"># Suzy&#39;s throw doesn&#39;t *encourage* Billy to throw</span>
           <span class="st">&quot;Billy[Suzy=1]&gt;Billy[Suzy=0]&quot;</span>))
<span class="kw">plot_dag</span>(model)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Here “Suzy” means Suzy throws, “Billy”: means Billy throws—which he might not do if Suzy throws—and “Smash” means the bottle gets smashed.
The version here is a somewhat less deterministic version of the classic account. Suzy is still an ace shot but now she may or may not throw and Billy may or may not respond positively to Suzy and if he does respond he may or may not be successful. With all these possibilities we have twelve unit causal types instead of 1.</p>
<p>We have two estimands of interest: counterfactual causation and actual causation. Conditional on Suzy throwing and the bottle breaking, would the bottle not have broken had Suzy not thrown her stone. That’s counterfactual causation. The actual causation asks the same question but <em>conditioning</em> on the fact that Billy did or did not thrown <em>his</em> stone—which we know could itself be due to Suzy throwing her stone. If so then we might think of an “active path” from Suzy’s throw to the smashing, even though had she not thrown the bottle would have smashed anyhow.</p>
<p>Our results:</p>
<pre class="sourceCode r"><code class="sourceCode r">actual_cause &lt;-<span class="st"> </span><span class="kw">query_model</span>(model, <span class="dt">using =</span> <span class="st">&quot;priors&quot;</span>,
  <span class="dt">queries =</span> <span class="kw">c</span>(
    <span class="dt">Counterfactual =</span> <span class="st">&quot;Smash[Suzy = 1] &gt; Smash[Suzy = 0]&quot;</span>,
    <span class="dt">Actual =</span> <span class="st">&quot;Smash[Suzy = 1, Billy = Billy[Suzy = 1] ] &gt; </span>
<span class="st">              Smash[Suzy = 0, Billy = Billy[Suzy = 1]]&quot;</span>),
  <span class="dt">subsets =</span> <span class="kw">c</span>(<span class="st">&quot;Suzy==1 &amp; Smash==1&quot;</span>, <span class="st">&quot;Suzy==1 &amp; Smash==1 &amp; Billy==0&quot;</span>, <span class="st">&quot;Suzy==1 &amp; Smash==1 &amp; Billy==1&quot;</span>),
  <span class="dt">expand_grid =</span> <span class="ot">TRUE</span>
  )</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Counterfactual</td>
<td align="left">Suzy==1 &amp; Smash==1</td>
<td align="left">priors</td>
<td align="right">0.669</td>
<td align="right">0.234</td>
</tr>
<tr class="even">
<td align="left">Counterfactual</td>
<td align="left">Suzy==1 &amp; Smash==1 &amp; Billy==0</td>
<td align="left">priors</td>
<td align="right">0.754</td>
<td align="right">0.217</td>
</tr>
<tr class="odd">
<td align="left">Counterfactual</td>
<td align="left">Suzy==1 &amp; Smash==1 &amp; Billy==1</td>
<td align="left">priors</td>
<td align="right">0.498</td>
<td align="right">0.288</td>
</tr>
<tr class="even">
<td align="left">Actual</td>
<td align="left">Suzy==1 &amp; Smash==1</td>
<td align="left">priors</td>
<td align="right">0.832</td>
<td align="right">0.168</td>
</tr>
<tr class="odd">
<td align="left">Actual</td>
<td align="left">Suzy==1 &amp; Smash==1 &amp; Billy==0</td>
<td align="left">priors</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">Actual</td>
<td align="left">Suzy==1 &amp; Smash==1 &amp; Billy==1</td>
<td align="left">priors</td>
<td align="right">0.498</td>
<td align="right">0.288</td>
</tr>
</tbody>
</table>
<p>Our inferences, <em>without even observing</em> Billy’s throw distinguish between Suzy being a counterfactual cause and an actual cause. We think it likely that Suzy’s throw was an actual cause of the outcome though we are less sure that it was a counterfactual causes. Observing Billy’s throw strengthens our inferences. If Billy didn’t throw then we are sure Suzy’s throw was the actual cause, though we are still in doubt about whether her throw was a counterfactual cause.</p>
<p>Note that if we observed Suzy <em>not</em> throwing then we would learn <em>more</em> about whether she would be a counterfactual cause since we would have learned more about whether Billy reacts to her and also about whether Billy is a good shot.</p>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Counterfactual</td>
<td align="left">Suzy==0 &amp; Billy==0</td>
<td align="left">priors</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">Counterfactual</td>
<td align="left">Suzy==0 &amp; Billy==1</td>
<td align="left">priors</td>
<td align="right">0.497</td>
<td align="right">0.288</td>
</tr>
<tr class="odd">
<td align="left">Counterfactual</td>
<td align="left">Suzy==0 &amp; Billy==1 &amp; Smash==1</td>
<td align="left">priors</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">Actual</td>
<td align="left">Suzy==0 &amp; Billy==0</td>
<td align="left">priors</td>
<td align="right">1.000</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">Actual</td>
<td align="left">Suzy==0 &amp; Billy==1</td>
<td align="left">priors</td>
<td align="right">0.751</td>
<td align="right">0.221</td>
</tr>
<tr class="even">
<td align="left">Actual</td>
<td align="left">Suzy==0 &amp; Billy==1 &amp; Smash==1</td>
<td align="left">priors</td>
<td align="right">0.506</td>
<td align="right">0.286</td>
</tr>
</tbody>
</table>
</div>
<div id="an-iv-model" class="section level2">
<h2><span class="header-section-number">17.8</span> An IV model</h2>
<p>We define a simple mediation model and illustrate learning about whether <span class="math inline">\(X=1\)</span> caused <span class="math inline">\(Y=1\)</span> from observations of <span class="math inline">\(M\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X -&gt; M -&gt; Y&quot;</span>)  <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_confound</span>(<span class="dt">confound =</span> <span class="kw">list</span>(<span class="dt">M =</span> <span class="st">&quot;Y[M=1]==1&quot;</span>)) 

<span class="kw">plot_dag</span>(model)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span>gbiqq<span class="op">::</span><span class="kw">query_model</span>(
    updated, 
    <span class="dt">queries =</span> <span class="kw">list</span>(<span class="dt">ATE =</span> <span class="st">&quot;c(Y[M=1] - Y[M=0])&quot;</span>), 
    <span class="dt">subsets =</span> <span class="kw">list</span>(<span class="ot">TRUE</span>, <span class="st">&quot;M[X=1] &gt; M[X=0]&quot;</span>,  <span class="st">&quot;M==0&quot;</span>,  <span class="st">&quot;M==1&quot;</span>),
    <span class="dt">using =</span> <span class="st">&quot;posteriors&quot;</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">All</td>
<td align="left">posteriors</td>
<td align="right">0.590</td>
<td align="right">0.063</td>
</tr>
<tr class="even">
<td align="left">ATE</td>
<td align="left">M[X=1] &gt; M[X=0]</td>
<td align="left">posteriors</td>
<td align="right">0.592</td>
<td align="right">0.071</td>
</tr>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">M==0</td>
<td align="left">posteriors</td>
<td align="right">0.571</td>
<td align="right">0.120</td>
</tr>
<tr class="even">
<td align="left">ATE</td>
<td align="left">M==1</td>
<td align="left">posteriors</td>
<td align="right">0.607</td>
<td align="right">0.036</td>
</tr>
</tbody>
</table>
<p>We calculate the average causal effect for all and for the compliers and conditional on values of <span class="math inline">\(M\)</span>.</p>
</div>
<div id="an-illustration-of-identification-through-the-frontdoor" class="section level2">
<h2><span class="header-section-number">17.9</span> An illustration of identification through the frontdoor</h2>
<p>Consider the following model:</p>
<pre class="sourceCode r"><code class="sourceCode r">frontdoor &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X -&gt; M -&gt; Y&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">set_confound</span>(<span class="kw">list</span>(<span class="dt">X =</span> <span class="st">&quot;Y[M=1]&gt;Y[M=0]&quot;</span>, 
                    <span class="dt">X =</span> <span class="st">&quot;Y[M=1]&lt;Y[M=0]&quot;</span>))

<span class="kw">plot_dag</span>(frontdoor)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>FLAG (fix confound arrows)</p>
<p>Below we plot posterior distributions given observations on 2000 units, with and without data on <span class="math inline">\(M\)</span>:</p>
<p><img src="ii_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
<div id="a-model-with-a-violation-of-sequential-ignorability" class="section level2">
<h2><span class="header-section-number">17.10</span> A model with a violation of sequential ignorability</h2>
</div>
<div id="learning-from-a-collider" class="section level2">
<h2><span class="header-section-number">17.11</span> Learning from a collider</h2>
<p>Pearl describes a model similar to the following as a case for which controlling for covariate <span class="math inline">\(W\)</span> induces bias in the estimation of the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>, which could otherwise be estimated without bias.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X -&gt; Y &lt;- S; S -&gt; W&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_confound</span>(<span class="kw">list</span>(<span class="dt">X =</span> <span class="st">&quot;W[S=1]&gt;W[S=0]&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_parameters</span>(<span class="dt">parameters =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, 
                          <span class="fl">.5</span>, <span class="fl">.5</span>, 
                          <span class="fl">.9</span>, <span class="fl">.1</span>, 
                          <span class="fl">.1</span>,.<span class="dv">1</span>,.<span class="dv">7</span>,.<span class="dv">1</span>,
                          <span class="fl">.2</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="fl">.6</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>)) 

<span class="kw">plot_dag</span>(model)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(model, <span class="dt">n =</span>  <span class="dv">20000</span>)
data<span class="op">$</span>S &lt;-<span class="st"> </span><span class="ot">NA</span></code></pre>
<p>The true effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> is .3 but the PC is quite different for units with <span class="math inline">\(W=0\)</span> and <span class="math inline">\(W=1\)</span>:</p>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Y(1)-Y(0)</td>
<td align="left">All</td>
<td align="left">parameters</td>
<td align="right">0.300</td>
</tr>
<tr class="even">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">parameters</td>
<td align="right">0.600</td>
</tr>
<tr class="odd">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1 &amp; W==0</td>
<td align="left">parameters</td>
<td align="right">0.083</td>
</tr>
<tr class="even">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1 &amp; W==1</td>
<td align="left">parameters</td>
<td align="right">0.744</td>
</tr>
</tbody>
</table>
<p>These are the quantities we seek to recover. The ATE can be gotten fairly precisely in a simple regression. But controlling for <span class="math inline">\(W\)</span> introduces bias both for the unconditional and the conditional effects of <span class="math inline">\(X\)</span>:</p>
<table style="text-align:center">
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
Y
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
X
</td>
<td>
0.298<sup>***</sup>
</td>
<td>
0.294<sup>***</sup>
</td>
<td>
0.028<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
<td>
(0.006)
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
W
</td>
<td>
</td>
<td>
0.374<sup>***</sup>
</td>
<td>
0.018<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.006)
</td>
<td>
(0.010)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
X:W
</td>
<td>
</td>
<td>
</td>
<td>
0.537<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
(0.012)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.199<sup>***</sup>
</td>
<td>
0.016<sup>***</sup>
</td>
<td>
0.190<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.006)
</td>
<td>
(0.006)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
20,000
</td>
<td>
20,000
</td>
<td>
20,000
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.083
</td>
<td>
0.229
</td>
<td>
0.296
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.083
</td>
<td>
0.229
</td>
<td>
0.296
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.469 (df = 19998)
</td>
<td>
0.430 (df = 19997)
</td>
<td>
0.410 (df = 19996)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
1,806.657<sup>***</sup> (df = 1; 19998)
</td>
<td>
2,971.444<sup>***</sup> (df = 2; 19997)
</td>
<td>
2,807.135<sup>***</sup> (df = 3; 19996)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="3" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>How does the Bayesian model do, with and without data on <span class="math inline">\(W\)</span>?</p>
<p>Inferences that do not use <span class="math inline">\(W\)</span> get ATE right on average, but PC is not identified and statements about PC conditional on <span class="math inline">\(W\)</span> are not possible:</p>
<p>Without <span class="math inline">\(W\)</span>:</p>
<table>
<caption><span id="tab:unnamed-chunk-55">Table 17.2: </span>Collider excluded from model</caption>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Y(1)-Y(0)</td>
<td align="left">All</td>
<td align="left">posteriors</td>
<td align="right">0.301</td>
<td align="right">0.007</td>
</tr>
<tr class="even">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">posteriors</td>
<td align="right">0.798</td>
<td align="right">0.056</td>
</tr>
<tr class="odd">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1 &amp; W==0</td>
<td align="left">posteriors</td>
<td align="right">0.792</td>
<td align="right">0.066</td>
</tr>
<tr class="even">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1 &amp; W==1</td>
<td align="left">posteriors</td>
<td align="right">0.793</td>
<td align="right">0.065</td>
</tr>
</tbody>
</table>
<p>We see including the collider does not induce error in estimation of the ATE, even though it does in a regression framework. It provides an ability to make different PC case level claims given W, but these are nevertheless far off in this example because we still do not have identification.</p>
<p>With <span class="math inline">\(W\)</span>:</p>
<table>
<caption><span id="tab:unnamed-chunk-56">Table 17.3: </span>Collider included in model</caption>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Y(1)-Y(0)</td>
<td align="left">All</td>
<td align="left">posteriors</td>
<td align="right">0.302</td>
<td align="right">0.006</td>
</tr>
<tr class="even">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1</td>
<td align="left">posteriors</td>
<td align="right">0.792</td>
<td align="right">0.039</td>
</tr>
<tr class="odd">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1 &amp; W==0</td>
<td align="left">posteriors</td>
<td align="right">0.626</td>
<td align="right">0.121</td>
</tr>
<tr class="even">
<td align="left">Y(1)-Y(0)</td>
<td align="left">X==1 &amp; Y==1 &amp; W==1</td>
<td align="left">posteriors</td>
<td align="right">0.839</td>
<td align="right">0.039</td>
</tr>
</tbody>
</table>
</div>
<div id="inferring-a-cause-from-symptoms" class="section level2">
<h2><span class="header-section-number">17.12</span> Inferring a cause from symptoms</h2>
<p>Sometimes we want to know whether a particular condition was present that could have caused an observed outcome. This is the stuff of medical diagnosis: on observing symptoms, is the sickness due to <span class="math inline">\(A\)</span> or to <span class="math inline">\(B\)</span>?</p>
<p>We imagine cases in which we do not get to observe the putative cause directly and we want to infer both whether the putative cause was present and whether it caused the outcome. This requires stating a query on both an effect and the level of an unobserved node.</p>
<p>An illustration:</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;A -&gt; S -&gt; Y &lt;- B&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">set_restrictions</span>(<span class="kw">c</span>(<span class="st">&quot;(S[A=1]&lt; S[A=0])&quot;</span>, 
                   <span class="st">&quot;(Y[S=1]&lt;Y[S=0])&quot;</span>,
                   <span class="st">&quot;(Y[S = 0, B = 0]== 1)&quot;</span>))

<span class="kw">query_model</span>(model, 
       <span class="dt">queries =</span> <span class="kw">list</span>(<span class="dt">A=</span><span class="st">&quot;(Y[A=1] &gt; Y[A =0]) &amp; A==1&quot;</span>, <span class="dt">B=</span><span class="st">&quot;(Y[B=1] &gt; Y[B =0]) &amp; B==1&quot;</span>),
       <span class="dt">subsets =</span> <span class="kw">list</span>(<span class="st">&quot;Y==1&quot;</span>,  <span class="st">&quot;Y==1 &amp; S==1&quot;</span>), <span class="dt">using =</span> <span class="st">&quot;priors&quot;</span>, 
       <span class="dt">expand_grid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>kable</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">Y==1</td>
<td align="left">priors</td>
<td align="right">0.199</td>
<td align="right">0.204</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">Y==1 &amp; S==1</td>
<td align="left">priors</td>
<td align="right">0.255</td>
<td align="right">0.231</td>
</tr>
<tr class="odd">
<td align="left">B</td>
<td align="left">Y==1</td>
<td align="left">priors</td>
<td align="right">0.439</td>
<td align="right">0.259</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">Y==1 &amp; S==1</td>
<td align="left">priors</td>
<td align="right">0.285</td>
<td align="right">0.218</td>
</tr>
</tbody>
</table>
<p>In this example there are two possible causes of interest, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. With flat priors the <span class="math inline">\(B\)</span> path starts as more probable. Observation of symptom <span class="math inline">\(S\)</span>, which is a consequence of <span class="math inline">\(A\)</span>, however raises the chances that the outcome is due to <span class="math inline">\(A\)</span> and lowers the chances that it is due to <span class="math inline">\(B\)</span>.</p>
</div>
<div id="a-model-mixing-observational-and-experimental-data" class="section level2">
<h2><span class="header-section-number">17.13</span> A model mixing observational and experimental data</h2>
<p>We imagine that node <span class="math inline">\(R\)</span> indicates whether a unit was assigned to be randomly assigned to treatment assignment (<span class="math inline">\(X=Z\)</span> if <span class="math inline">\(R=1\)</span>) or took on its observational value (<span class="math inline">\(X=O\)</span> if <span class="math inline">\(R=0\)</span>). We assume the exclusion restriction that entering the experimental sample is not related to <span class="math inline">\(Y\)</span> other than through assignment of <span class="math inline">\(X\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;R -&gt; X; O -&gt;X; Z -&gt; X; X -&gt; Y&quot;</span>, 
                    <span class="dt">add_priors =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_restrictions</span>(<span class="st">&quot;(X[R=1, Z=0]!=0) | </span>
<span class="st">                           (X[R=1, Z=1]!=1) | </span>
<span class="st">                           (X[R=0, O=0]!=0) | </span>
<span class="st">                           (X[R=0, O=1]!=1)&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_priors</span>() <span class="op">%&gt;%</span>
<span class="st">         </span><span class="kw">set_confound</span>(<span class="kw">list</span>(<span class="dt">O =</span> <span class="st">&quot;(Y[X=1] &gt; Y[X=0])&quot;</span>, 
                           <span class="dt">O =</span> <span class="st">&quot;(Y[X=1] &lt; Y[X=0])&quot;</span>, 
                           <span class="dt">O =</span> <span class="st">&quot;(Y[X=1] == 1)&quot;</span>))

<span class="kw">plot_dag</span>(model)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>The parameter matrix has just one type for <span class="math inline">\(X\)</span> since <span class="math inline">\(X\)</span> really operates here as a kind of switch, inheriting the value of <span class="math inline">\(Z\)</span> or <span class="math inline">\(O\)</span> depending on <span class="math inline">\(R\)</span>. Parameters allow for complete confounding between <span class="math inline">\(O\)</span> and <span class="math inline">\(Y\)</span> by <span class="math inline">\(Z\)</span> and <span class="math inline">\(Y\)</span> are unconfounded.</p>
<pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">set_parameters</span>(model, <span class="kw">c</span>(.<span class="dv">2</span>, <span class="fl">.8</span>, 
                                 <span class="fl">.8</span>, <span class="fl">.2</span>, 
                                 <span class="fl">.2</span>, <span class="fl">.8</span>, 
                                 <span class="fl">.8</span>, <span class="fl">.2</span>, 
                                 <span class="fl">.5</span>, <span class="fl">.5</span>, 
                                 <span class="fl">.5</span>, <span class="fl">.5</span>, 
                                 <span class="dv">1</span>,
                                 <span class="fl">.2</span>, <span class="fl">.2</span>, <span class="fl">.4</span>, <span class="fl">.2</span>))</code></pre>
<p>The estimands:</p>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">All</td>
<td align="left">parameters</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="left">ATE</td>
<td align="left">R==0</td>
<td align="left">parameters</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">R==1</td>
<td align="left">parameters</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
<p>The priors:</p>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">All</td>
<td align="left">priors</td>
<td align="right">-0.003</td>
<td align="right">0.31</td>
</tr>
<tr class="even">
<td align="left">ATE</td>
<td align="left">R==0</td>
<td align="left">priors</td>
<td align="right">-0.003</td>
<td align="right">0.31</td>
</tr>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">R==1</td>
<td align="left">priors</td>
<td align="right">-0.003</td>
<td align="right">0.31</td>
</tr>
</tbody>
</table>
<p>Data:</p>
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(model, <span class="dt">n =</span> <span class="dv">600</span>)

<span class="co"># Uncomment if data on $O$ is not available for cases assigned to $R=1$.</span>
<span class="co"># data$O[data$R == 1] &lt;- NA   </span></code></pre>
<p>The true effect is .2 but naive analysis on the observational data would yield a srtongly upwardly biased estimate.</p>
<p>The gbiqq estimates are:</p>
<pre class="sourceCode r"><code class="sourceCode r">posterior &lt;-<span class="st"> </span><span class="kw">gbiqq</span>(model, data)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">All</td>
<td align="left">posteriors</td>
<td align="right">0.19</td>
<td align="right">0.048</td>
</tr>
<tr class="even">
<td align="left">ATE</td>
<td align="left">R==0</td>
<td align="left">posteriors</td>
<td align="right">0.19</td>
<td align="right">0.048</td>
</tr>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">R==1</td>
<td align="left">posteriors</td>
<td align="right">0.19</td>
<td align="right">0.048</td>
</tr>
</tbody>
</table>
<p>Did observational data improve the estimates from the experimental data?</p>
<pre class="sourceCode r"><code class="sourceCode r">posterior &lt;-<span class="st"> </span><span class="kw">gbiqq</span>(model, data[data<span class="op">$</span>R<span class="op">==</span><span class="dv">1</span>,])</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">All</td>
<td align="left">posteriors</td>
<td align="right">0.227</td>
<td align="right">0.053</td>
</tr>
<tr class="even">
<td align="left">ATE</td>
<td align="left">R==0</td>
<td align="left">posteriors</td>
<td align="right">0.227</td>
<td align="right">0.053</td>
</tr>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">R==1</td>
<td align="left">posteriors</td>
<td align="right">0.227</td>
<td align="right">0.053</td>
</tr>
</tbody>
</table>
<p>A key quantity of interest from this model is the average effect of treatment conditional on being in treatment in the observational group. We have:</p>
<table>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">R==1 &amp; X==0</td>
<td align="left">posteriors</td>
<td align="right">0.190</td>
<td align="right">0.048</td>
</tr>
<tr class="even">
<td align="left">ATE</td>
<td align="left">R==1 &amp; X==1</td>
<td align="left">posteriors</td>
<td align="right">0.190</td>
<td align="right">0.048</td>
</tr>
<tr class="odd">
<td align="left">ATE</td>
<td align="left">R==0 &amp; X==0</td>
<td align="left">posteriors</td>
<td align="right">-0.122</td>
<td align="right">0.072</td>
</tr>
<tr class="even">
<td align="left">ATE</td>
<td align="left">R==0 &amp; X==1</td>
<td align="left">posteriors</td>
<td align="right">0.414</td>
<td align="right">0.060</td>
</tr>
</tbody>
</table>
</div>
<div id="sample-selection-bias" class="section level2">
<h2><span class="header-section-number">17.14</span> Sample selection bias</h2>
<p>As an example consider the below from <span class="citation">Bareinboim and Pearl (<a href="#ref-bareinboim2016causal">2016</a>)</span> (their Figure 4C). The key feature is that data is only seen for units with <span class="math inline">\(S=1\)</span>.</p>
<p>In this model the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is confounded. Controlling for either <span class="math inline">\(Z\)</span> or for <span class="math inline">\(W1\)</span> <em>and</em> <span class="math inline">\(W2\)</span> can address this confounding, but only controlling for <span class="math inline">\(Z\)</span> can capture sample selection. The reason is that <span class="math inline">\(Z\)</span> is independent of <span class="math inline">\(S\)</span> and so variation in <span class="math inline">\(Z\)</span> is not affected by selection on <span class="math inline">\(S\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">fusion &lt;-<span class="st"> </span><span class="kw">make_model</span>(<span class="st">&quot;X &lt;- W1 -&gt; W2 -&gt; X -&gt; Y &lt;- Z -&gt; W2; W1 -&gt; S&quot;</span>)</code></pre>
<p><img src="ii_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>To keep the parameter and type space small we also impose a set of restrictions: <span class="math inline">\(S\)</span> is non decreasing in <span class="math inline">\(W_1\)</span>, <span class="math inline">\(X\)</span> is not decreasing in either <span class="math inline">\(W1\)</span> or <span class="math inline">\(W2\)</span>, <span class="math inline">\(Y\)</span> is not decreasing <span class="math inline">\(Z\)</span> or <span class="math inline">\(X\)</span> and <span class="math inline">\(X\)</span> affects <span class="math inline">\(Y\)</span> only if <span class="math inline">\(Z=1\)</span>. <span class="math inline">\(W_2=1\)</span> if and only if both <span class="math inline">\(W_1=1\)</span> and <span class="math inline">\(Z=1\)</span>. These all reduce the problem to one with 18 nodal types and 288 causal types.</p>
<p>Given these priors we will assume a true (unknown) dgp with no effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>, in which <span class="math inline">\(W_1\)</span> arises with a <span class="math inline">\(1/3\)</span> probability but has a strong positive effect on selection into the sample when it does arise.</p>
<p>The estimand values given the true parameters and priors for this model are as shown below.</p>
<table>
<caption><span id="tab:unnamed-chunk-74">Table 17.4: </span>Estimand values</caption>
<thead>
<tr class="header">
<th align="left">Query</th>
<th align="left">Subset</th>
<th align="left">Using</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Q 1</td>
<td align="left">All</td>
<td align="left">parameters</td>
<td align="right">0.000</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Q 1</td>
<td align="left">All</td>
<td align="left">priors</td>
<td align="right">0.124</td>
<td align="right">0.133</td>
</tr>
</tbody>
</table>
<p>We can see the inference challenge from observational data using regression analysis with and without conditioning on <span class="math inline">\(Z\)</span>.</p>
<table style="text-align:center">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Y
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
X
</td>
<td>
0.075<sup>***</sup>
</td>
<td>
0.009
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Z_norm
</td>
<td>
</td>
<td>
0.329<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.010)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
X:Z_norm
</td>
<td>
</td>
<td>
-0.024
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.015)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.465<sup>***</sup>
</td>
<td>
0.497<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.005)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
16,604
</td>
<td>
16,604
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.006
</td>
<td>
0.103
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.005
</td>
<td>
0.102
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.499 (df = 16602)
</td>
<td>
0.474 (df = 16600)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
92.718<sup>***</sup> (df = 1; 16602)
</td>
<td>
632.864<sup>***</sup> (df = 3; 16600)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Bayesian inferences given different data strategies are shown below:</p>
<table>
<thead>
<tr class="header">
<th align="left">data</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">X,Y</td>
<td align="right">0.033</td>
<td align="right">0.020</td>
</tr>
<tr class="even">
<td align="left">X,Y, W1, W2</td>
<td align="right">0.011</td>
<td align="right">0.006</td>
</tr>
<tr class="odd">
<td align="left">X, Y, Z</td>
<td align="right">0.003</td>
<td align="right">0.003</td>
</tr>
</tbody>
</table>
</div>
<div id="transportation-of-findings-across-contexts" class="section level2">
<h2><span class="header-section-number">17.15</span> Transportation of findings across contexts</h2>
<p>We study the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> in country 1 and want to make inferences to country 2, Our problem however is that units are heterogeneous and features, <span class="math inline">\(W_1\)</span>, that differ across units may be related both to treatment assignment, outcomes, and selection into the sample.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-bareinboim2016causal">
<p>Bareinboim, Elias, and Judea Pearl. 2016. “Causal Inference and the Data-Fusion Problem.” <em>Proceedings of the National Academy of Sciences</em> 113 (27): 7345–52.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="final-words.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
